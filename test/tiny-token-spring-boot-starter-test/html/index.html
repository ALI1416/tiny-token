<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Title</title>
</head>

<body>
<h3>配置</h3>
<div>
  <label for="urlText">URL：</label><input id="urlText" type="text" value="http://127.0.0.1:8080/">
  <br>
  <label for="headerText">Header：</label><input id="headerText" type="text" value="Authorization">
  <br>
  <label for="usernameText">用户名：</label><input id="usernameText" type="text" value="root">
  <br>
  <label for="passwordText">密码：</label><input id="passwordText" type="text" value="admin">
  <br>
  <input id="loginBtn" type="button" value="登录">
</div>
<h3>登录消息</h3>
<div id="loginMsg">暂无</div>
<h3>错误消息</h3>
<div id="errorMsg">暂无</div>
<script>
  const urlText = document.getElementById('urlText')
  const headerText = document.getElementById('headerText')
  const usernameText = document.getElementById('usernameText')
  const passwordText = document.getElementById('passwordText')
  const loginBtn = document.getElementById('loginBtn')
  const loginMsg = document.getElementById('loginMsg')
  const errorMsg = document.getElementById('errorMsg')

  /**
   * 点击登录按钮
   */
  loginBtn.addEventListener('click', () => {
    login().then(res => {
      loginMsg.innerText = res == 'true' ? '登录成功' : '登录失败'
    })
  })

  /**
   * 登录
   */
  function login() {
    return myFetch('isCorrect')
  }

  function myFetch(path) {
    const auth = btoa(usernameText.value + ':' + passwordText.value)
    return fetch(urlText.value + path, {headers: {mode: 'no-cors', [headerText.value]: auth}})
      .then(res => res.text())
      .catch(e => {
        errorMsg.innerText = '接口[' + path + ']调用失败\n' + e
        throw e
      })
  }
</script>
</body>

</html>